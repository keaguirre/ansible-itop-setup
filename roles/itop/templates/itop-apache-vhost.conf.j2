<VirtualHost *:80>
    ServerName {{ itop_server_name }}
    DocumentRoot {{ itop_web_root }}

    <Directory {{ itop_web_root }}>
        AllowOverride All
        Require all granted
        Options FollowSymLinks
    </Directory>

    # PHP-FPM v√≠a proxy_fcgi (Apache)
    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php/php{{ php_version }}-fpm-{{ php_fpm_pool }}.sock|fcgi://localhost/"
    </FilesMatch>

    # Cabeceras/expiraciones recomendadas
    <IfModule mod_headers.c>
        Header always set X-Content-Type-Options "nosniff"
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set X-XSS-Protection "1; mode=block"
    </IfModule>

    <IfModule mod_expires.c>
        ExpiresActive On
        ExpiresByType image/jpg "access plus 1 month"
        ExpiresByType image/jpeg "access plus 1 month"
        ExpiresByType image/gif "access plus 1 month"
        ExpiresByType image/png "access plus 1 month"
        ExpiresByType text/css "access plus 1 week"
        ExpiresByType application/javascript "access plus 1 week"
    </IfModule>

    ErrorLog ${APACHE_LOG_DIR}/itop_error.log
    CustomLog ${APACHE_LOG_DIR}/itop_access.log combined
</VirtualHost>
